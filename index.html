<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>Q2推荐奖赏</title>
  <script>
    window.onload = function () {
      const validPasswords = ["kwm_2025", "kwm_2025_2", "kwm_honor", 'deyor_q2v3','deq2qv3v']; // 多组密码
      const downloadedKey = "downloaded_passwords"; // localStorage的键

      // 获取已下载过的密码列表
      const downloaded = JSON.parse(localStorage.getItem(downloadedKey) || "[]");

      const userInput = prompt("请输入密码：");

      if (validPasswords.includes(userInput)) {
        if (downloaded.includes(userInput)) {
          alert("该密码已使用，无法重复下载。");
        } else {
          // 下载文件
          const link = document.createElement('a');
          link.href = "DeyorQ2-V4.xlsx";
          link.download = "DeyorQ2.xlsx";
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);

          // 记录该密码已用
          downloaded.push(userInput);
          localStorage.setItem(downloadedKey, JSON.stringify(downloaded));
        }
      } else {
        alert("密码错误，请刷新页面重新输入。");
      }
    };
  </script>
</head>
<body>
</body>
</html>
